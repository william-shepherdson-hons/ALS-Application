name: Build and test

on:
    push:
        branches: [ "main" ]
    pull_request:
        branches: [ "main" ]
env:
    CARGO_TERM_COLOR: always

jobs:
    Pull:
        defaults:
            run:
                working-directory: /home/dietpi/ALS-Application/
        runs-on: self-hosted
        steps:
        - name: Pull
          run: git pull
    Test:
        needs:  Pull
        defaults:
            run:
                working-directory: /home/dietpi/ALS-Application/src-tauri/
        runs-on: self-hosted
        steps:
        - name: Build
          run: /home/dietpi/.cargo/bin/cargo build --verbose
        - name: Run tests
          run: /home/dietpi/.cargo/bin/cargo test --verbose
